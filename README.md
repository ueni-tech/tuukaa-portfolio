# はじめに

生成AI利用が一般化した現在、生成AI統合のwebアプリの仕組みを実際に作って理解したいという思いからこのアプリの開発を始めました。\
最初はOpenAI APIと連携する程度のChatGPTクローンの開発を想定していましたが、LangChainやRAGにも興味を持ちはじめたことで現在のサービスの姿になりました。

---

## 📌 プロジェクト概要

このプロジェクトは、**RAG（Retrieval-Augmented Generation）技術を活用した埋め込み型AIチャットボットサービス**です。

### サービスの仕組み

企業のWebサイトに簡単にAIチャットボットを導入できるSaaS型のサービスです。

```
サービス管理者（私）
    ↓ ①埋め込みスクリプトを発行
顧客企業（Webサイト運営者）
    ↓ ②自社サイトに設置
エンドユーザー（サイト訪問者）
    ↓ ③チャットで質問
AIチャットボット
    ↓ ④質問内容を集約・分析
レポート生成 → 顧客企業へ提供
```

### 登場人物

- **サービス管理者（私）**: このシステムを運営し、顧客企業に埋め込みスクリプトを発行
- **顧客企業**: AIチャットボットを自社Webサイトに導入したい企業
- **エンドユーザー**: 顧客企業のWebサイトを訪問し、チャットボットに質問する一般ユーザー

### 提供価値

1. **顧客企業にとって**
   - ワンライナーのJSスクリプトタグを埋め込むだけで導入完了
   - カスタマーサポートの問い合わせ対応コストを削減
   - 「お問い合わせフォームを送るほどではない」小さな疑問を拾い上げ
   - エンドユーザーの質問傾向をレポートで可視化し、サイト改善に活用

2. **エンドユーザーにとって**
   - 24時間いつでも即座に回答を得られる
   - 気軽に質問できる心理的ハードルの低さ

### 🎯 主な機能

#### 管理者機能（サービス管理者向け）
- **文書管理**: PDF、Word、Excel、テキストファイルのアップロードと解析
- **埋め込みキー発行**: 顧客企業ごとに専用のスクリプトタグを生成
- **レポート表示**: エンドユーザーからの質問内容を集約・分析
- **認証システム**: Google OAuthによる安全なログイン

#### チャットボット機能（エンドユーザー向け）
- **AI質問応答**: アップロードされた文書をもとに自然言語で回答を生成
- **ベクトル検索**: ChromaDBを使用した高速な意味検索（RAG）
- **レスポンシブデザイン**: PCからスマートフォンまで対応

### 🌐 ポートフォリオ用デモサイト  
- **サービス管理画面（デモアカウントでログイン）**
  - [https://tuukaa-portfolio.vercel.app/portfolio-login](https://tuukaa-portfolio.vercel.app/portfolio-login)
  - ログインするとデモアカウントでサービス管理者用の管理画面に遷移し、チャット機能・レポート機能がお試しいただけます
  - 認証情報は別途共有いたします
- **顧客企業向けチャットテストページ**
  - [https://tuukaa-portfolio.vercel.app/widget-test?key=demo123](https://tuukaa-portfolio.vercel.app/widget-test?key=demo123)
  - 顧客企業向けに公開しているページでここでは実際のウィジェットを使ってチャットテストをしていただけます

### 💬 デモデータと質問例

ポートフォリオ用デモサイトでは、アップル社の**Apple Intelligenceに関する公式ドキュメント**をデモデータとしてアップロード済みです。

**試してみてください**:

#### 基本機能
- 「Apple Intelligenceとは何ですか？」
- 「どのデバイス・OSで使えますか？」
- 「どのバージョンのOSから使えますか？」
- 「対応言語は何ですか？」

#### 具体的な機能
- 「Writing Toolsの機能を教えて」
- 「画像生成機能について説明して」
- 「Siriの新機能は何ですか？」

#### プライバシーとセキュリティ
- 「データのプライバシーはどう保護されていますか？」

#### 使い方
- 「Apple Intelligenceを有効にする方法は？」
- 「どうやって使い始めればいいですか？」

---

## 🛠️ 技術スタック

### フロントエンド

| 技術 | バージョン | 用途 |
|------|-----------|------|
| **Next.js** | 15.4.5 | Reactベースのフルスタックフレームワーク（App Router使用） |
| **TypeScript** | 5.x | 型安全な開発環境 |
| **Tailwind CSS** | 4.x | ユーティリティファーストのCSSフレームワーク |
| **NextAuth.js** | - | Google OAuth認証の実装 |
| **React Hook Form** | - | フォーム管理 |

### バックエンド

| 技術 | バージョン | 用途 |
|------|-----------|------|
| **FastAPI** | 0.104.1 | 高速なPython製Webフレームワーク |
| **Python** | 3.11 | バックエンド言語 |
| **LangChain** | 0.3.25 | LLMアプリケーション開発フレームワーク |
| **OpenAI API** | - | GPTモデルによる回答生成 |
| **ChromaDB** | 1.0.12 | ベクトルデータベース（埋め込み検索） |
| **Poetry** | - | Pythonパッケージ管理 |

### インフラ・DevOps

| 技術 | 用途 |
|------|------|
| **Docker** | コンテナ化による環境の統一 |
| **Docker Compose** | ローカル開発環境の構築 |
| **Vercel** | フロントエンドのホスティング |
| **Fly.io** | バックエンドAPIのホスティング |
| **GitHub Actions** | CI/CDパイプライン（自動デプロイ） |

### 開発ツール

- **ESLint** / **Prettier**: コード品質とフォーマットの統一
- **Black** / **isort**: Pythonコードのフォーマット
- **Pydantic**: データバリデーション

---

## 🏗️ システムアーキテクチャ

```
┌─────────────────┐
│   ユーザー      │
└────────┬────────┘
         │
         ▼
┌─────────────────────────────┐
│  Next.js Frontend (Vercel)  │
│  - TypeScript               │
│  - Tailwind CSS             │
│  - NextAuth (Google OAuth)  │
└────────┬────────────────────┘
         │ REST API
         ▼
┌─────────────────────────────┐
│  FastAPI Backend (Fly.io)   │
│  - LangChain                │
│  - OpenAI API               │
│  - ChromaDB                 │
└─────────────────────────────┘
```

### RAG（検索拡張生成）の仕組み

1. **文書の取り込み**: ファイルをアップロード
2. **チャンク分割**: 文書を適切なサイズに分割
3. **埋め込み生成**: OpenAIのEmbedding APIでベクトル化
4. **ベクトル保存**: ChromaDBに保存
5. **質問処理**: ユーザーの質問をベクトル化
6. **類似検索**: ChromaDBから関連する文書チャンクを検索
7. **回答生成**: 検索結果をコンテキストとしてGPTに渡し、回答を生成

---

## 💡 実装のポイント

### 1. フルスタック開発

- フロントエンド（Next.js）とバックエンド（FastAPI）を分離した、スケーラブルな設計
- TypeScriptによる型安全な開発で、バグを未然に防止
- RESTful APIの設計と実装

### 2. AI/ML技術の活用

- LangChainを使用したRAGパイプラインの構築
- OpenAI APIとの統合（Embeddings + GPT）
- ベクトルデータベース（ChromaDB）による高速な意味検索

### 3. 認証・セキュリティ

- NextAuth.jsによるGoogle OAuth認証の実装
- 環境変数による機密情報の管理
- CORS設定によるセキュアなAPI通信
- 管理者権限とポートフォリオアカウント（閲覧専用）の2段階アクセス制御

### 4. クラウドインフラ

- Vercel（フロントエンド）とFly.io（バックエンド）への本番デプロイ
- Dockerによるコンテナ化で環境差異を解消
- GitHub Actionsによる自動デプロイパイプライン（未完）

### 5. コード品質

- ESLint、Prettier、Blackによるコードフォーマットの統一
- TypeScriptとPydanticによる型安全性の確保
- モジュール分割による保守性の向上

---

## 📂 プロジェクト構成

```
tuukaa-portfolio/
├── frontend/              # Next.jsフロントエンド
│   ├── src/
│   │   ├── app/          # App Router（ページ・レイアウト）
│   │   ├── components/   # Reactコンポーネント
│   │   └── lib/          # ユーティリティ関数
│   ├── public/           # 静的ファイル
│   └── package.json
│
├── backend/              # FastAPIバックエンド
│   ├── app/
│   │   ├── api/         # APIエンドポイント
│   │   ├── core/        # RAGエンジン・文書処理
│   │   ├── models/      # データモデル
│   │   └── main.py      # アプリケーションエントリーポイント
│   └── pyproject.toml
│
├── docker-compose.yml    # ローカル開発環境
├── .github/
│   └── workflows/       # CI/CDパイプライン
└── docs/                # ドキュメント
```

---

## 🎓 学習した技術・スキル

このプロジェクトを通じて、以下の技術やスキルを習得しました：

- ✅ **フロントエンド開発**: Next.js（App Router）、TypeScript、Tailwind CSS
- ✅ **バックエンド開発**: FastAPI、Python、RESTful API設計
- ✅ **AI/ML**: LangChain、OpenAI API、RAG（検索拡張生成）、ベクトルデータベース
- ✅ **認証**: NextAuth.js、Google OAuth
- ✅ **インフラ**: Docker、Vercel、Fly.io
- ✅ **CI/CD**: GitHub Actions

---

## 📝 今後の改善予定
- エンドユーザーからの質問データ保護の強化（質問内容の暗号化、個人情報の匿名化、GDPR対応）
- ストリーミングレスポンスの実装
- レスポンス速度の最適化
- 対話形式のチャットの実装

---
